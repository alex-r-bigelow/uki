!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports):"function"==typeof define&&define.amd?define(["exports"],t):t(e.uki=e.uki||{})}(this,function(e){"use strict";var t=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")},n=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),r=function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)},i=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t},o=function(){function e(){t(this,e)}return n(e,[{key:"requireProperties",value:function(e){var t=this;e.forEach(function(e){if(void 0===t[e])throw new TypeError(e+" is undefined for class "+t.constructor.name)})}}]),e}(),s=function(e){function s(){t(this,s);var e=i(this,(s.__proto__||Object.getPrototypeOf(s)).call(this));return e.eventHandlers={},e}return r(s,o),n(s,[{key:"on",value:function(e,t,n){this.eventHandlers[e]||(this.eventHandlers[e]=[]),(n||-1===this.eventHandlers[e].indexOf(t))&&this.eventHandlers[e].push(t)}},{key:"off",value:function(e,t){if(this.eventHandlers[e])if(t){var n=this.eventHandlers[e].indexOf(t);n>=0&&this.eventHandlers[e].splice(n,1)}else delete this.eventHandlers[e]}},{key:"trigger",value:function(){var e=this,t=arguments[0],n=Array.prototype.slice.call(arguments,1);this.eventHandlers[t]&&this.eventHandlers[t].forEach(function(t){window.setTimeout(function(){t.apply(e,n)},0)})}}]),s}(),l=function(e){function o(){t(this,o);var e=i(this,(o.__proto__||Object.getPrototypeOf(o)).call(this));return e.d3el=null,e.dirty=!1,e.drawTimeout=null,e.debounceWait=100,e.requireProperties(["setup","draw"]),e}return r(o,s),n(o,[{key:"hasRenderedTo",value:function(e){var t=this.dirty;if(e)t=!this.d3el||(this.dirty||e.node()!==this.d3el.node()),this.d3el=e;else{if(!this.d3el)throw new Error("Called render() without an element to render to (and no prior element has been specified)");e=this.d3el}return this.dirty=!1,!t}},{key:"render",value:function(e){var t=this;e=e||this.d3el,this.hasRenderedTo(e)||(this.updateContainerCharacteristics(e),this.setup(e),this.d3el=e),clearTimeout(this.drawTimeout),this.drawTimeout=setTimeout(function(){t.drawTimeout=null,t.draw(e)},this.debounceWait)}},{key:"updateContainerCharacteristics",value:function(e){null!==e&&(this.emSize=parseFloat(e.style("font-size")),this.scrollBarSize=this.computeScrollBarSize(e))}},{key:"computeScrollBarSize",value:function(e){var t=document.createElement("div");t.style.visibility="hidden",t.style.width="100px",t.style.msOverflowStyle="scrollbar",e.node().appendChild(t);var n=t.offsetWidth;t.style.overflow="scroll";var r=document.createElement("div");r.style.width="100%",t.appendChild(r);var i=r.offsetWidth;return t.parentNode.removeChild(t),n-i}}]),o}();e.AbstractClass=o,e.Model=s,e.View=l,Object.defineProperty(e,"__esModule",{value:!0})});