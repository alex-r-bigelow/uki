!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports):"function"==typeof define&&define.amd?define(["exports"],t):t(e.mure={})}(this,function(e){"use strict";class t{requireProperties(e){e.forEach(e=>{if(void 0===this[e])throw new TypeError(e+" is undefined for class "+this.constructor.name)})}}class s extends t{constructor(){super(),this.eventHandlers={}}on(e,t,s){this.eventHandlers[e]||(this.eventHandlers[e]=[]),(s||-1===this.eventHandlers[e].indexOf(t))&&this.eventHandlers[e].push(t)}off(e,t){if(this.eventHandlers[e])if(t){let s=this.eventHandlers[e].indexOf(t);s>=0&&this.eventHandlers[e].splice(s,1)}else delete this.eventHandlers[e]}trigger(){let e=arguments[0],t=Array.prototype.slice.call(arguments,1);this.eventHandlers[e]&&this.eventHandlers[e].forEach(e=>{window.setTimeout(()=>{e.apply(this,t)},0)})}}e.AbstractClass=t,e.Model=s,e.View=class extends s{constructor(e=Promise.resolve()){super(),this.d3el=null,this.dirty=!1,this.drawTimeout=null,this.debounceWait=100,this.requireProperties(["setup","draw"]),(async()=>{await e,this.render()})()}hasRenderedTo(e){let t=this.dirty;if(e)t=!this.d3el||this.dirty||e.node()!==this.d3el.node(),this.d3el=e;else{if(!this.d3el)throw new Error("Called render() without an element to render to (and no prior element has been specified)");e=this.d3el}return this.dirty=!1,!t}render(e=this.d3el||d3.select("body")){this.hasRenderedTo(e)||(this.updateContainerCharacteristics(e),this.setup(e),this.d3el=e),clearTimeout(this.drawTimeout),this.drawTimeout=setTimeout(()=>{this.drawTimeout=null,this.draw(e)},this.debounceWait)}updateContainerCharacteristics(e){null!==e&&(this.bounds=e.node().getBoundingClientRect(),this.emSize=parseFloat(e.style("font-size")),this.scrollBarSize=this.computeScrollBarSize(e))}computeScrollBarSize(e){var t=document.createElement("div");t.style.visibility="hidden",t.style.width="100px",t.style.msOverflowStyle="scrollbar",e.node().appendChild(t);var s=t.offsetWidth;t.style.overflow="scroll";var i=document.createElement("div");i.style.width="100%",t.appendChild(i);var r=i.offsetWidth;return t.parentNode.removeChild(t),s-r}},Object.defineProperty(e,"__esModule",{value:!0})});
